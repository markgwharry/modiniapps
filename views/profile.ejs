<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Your profile · Modini Apps</title>
    <link rel="stylesheet" href="/css/styles.css" />
    <style>
      .card {
        max-width: 720px;
        margin: 2rem auto;
      }
      .form-group {
        margin-bottom: 1rem;
      }
      .form-group label {
        display: block;
        font-weight: 600;
        margin-bottom: 0.25rem;
      }
      .form-group input {
        width: 100%;
        padding: 0.75rem;
        border-radius: 6px;
        border: 1px solid rgba(0, 0, 0, 0.2);
        font-size: 1rem;
      }
      .form-errors,
      .form-success {
        margin: 1rem 0;
        padding: 1rem;
        border-radius: 8px;
      }
      .form-errors {
        background: #fef0f0;
        color: #7a0611;
      }
      .form-success {
        background: #e6f4ea;
        color: #0f5132;
      }
      .form-actions {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .secondary-link {
        font-size: 0.875rem;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="card">
        <header class="header">
          <div>
            <h1>Profile settings</h1>
            <p>Keep your account details up to date so admins can identify you quickly.</p>
          </div>
          <div class="actions">
            <a href="/" class="button secondary">← Back to dashboard</a>
          </div>
        </header>

        <% if (errors && errors.length) { %>
          <div class="form-errors" data-server-errors>
            <ul>
              <% errors.forEach(error => { %>
                <li><%= error %></li>
              <% }) %>
            </ul>
          </div>
        <% } %>

        <% if (success) { %>
          <div class="form-success" data-server-success><%= success %></div>
        <% } %>

        <form method="POST" action="/profile" data-profile-form>
          <div class="form-group">
            <label for="email">Email</label>
            <input id="email" name="email" type="email" value="<%= user.email %>" readonly />
            <small>Your email address is managed by the administrator.</small>
          </div>

          <div class="form-group">
            <label for="fullName">Full name</label>
            <input id="fullName" name="fullName" type="text" value="<%= user.fullName || '' %>" required />
          </div>

          <div class="form-group">
            <label for="jobTitle">Job title</label>
            <input id="jobTitle" name="jobTitle" type="text" value="<%= user.jobTitle || '' %>" />
          </div>

          <div class="form-group">
            <label for="phone">Phone</label>
            <input id="phone" name="phone" type="tel" value="<%= user.phone || '' %>" placeholder="e.g. +44 1234 567890" />
          </div>

          <div class="form-errors" data-runtime-errors hidden></div>

          <div class="form-actions">
            <a class="secondary-link" href="/profile/password">Update password →</a>
            <button class="button" type="submit">Save changes</button>
          </div>
        </form>
      </div>
    </div>

    <script type="application/json" id="profile-state">
      <%- JSON.stringify({
        values: {
          fullName: user.fullName || '',
          jobTitle: user.jobTitle || '',
          phone: user.phone || ''
        }
      }) %>
    </script>
    <script src="/js/account.js" defer></script>
  </body>
</html>
